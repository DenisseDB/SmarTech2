<!-- en action ponemos la ruta-->
<!-- <form action="/registrarTarea/nueva" method="POST" class="regTareaForm"> -->

  <div class="field is-static">
    <h1 class="titulo">Crear Tarea</h1>

    </div>

    <div class="regTarea"> 
          <div class="field-label is-normal"> 
            <div class="labelt">
            <div class="row">
              
             
            <label class="label">Proyecto al que pertence</label>
          </div>
        </div>
          <div class="row">
          <div class="field-body">
            <div class="field is-narrow">
              <div class="control">
                <div class="input-field">
                  <input class="input" type="text" placeholder="Proyecto..." name="nombreP" id="buscar">
                </div>
                <div id="listaProyectos">
                  
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>


          <div class="field-label is-normal">
            <div class="labelt">
            <div class="row">
              
            <label class="label">Nombre de tarea</label>
          </div>
        </div>
          <div class="row">
          <div class="field-body">
            <div class="field">
              <div class="control">
                <input class="input" type="text" placeholder="Escribe aqui" id="nombreT" name="nombreT">
              </div>
              <p class="help is-danger">
                This field is required
              </p>
            </div>
          </div>
        </div>

      <div class="row">
        <div class="field-label is-normal">
                <div class="field-body">
                  <div class="field is-narrow">
                    <div class="control">
                    <label class="label">Colaboradores</label>
                      <a class="button is-link is-outlined botonAgregarColaborador" onclick="agregarColaborador()"> + </a>
                      <%- nombreSesion %>
                      <div class="select is-fullwidth"> 
                        <select name="nombre" id="nombre"> 
                          <option value="" disabled selected> Selecciona a los colaboradores</option>
                          
                          <% for (let e of empleado) { %>
                            <option value ="<%= e.idEmpleado %>"><%= e.nombre%></option>
                          <% } %>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
                <div class="divColaboradores" id="listaColabradores">
                </div>


        
          <div class="field-label is-normal">
            <div class="labelt">
              <div class="row">
              <label class="label">HORAS DE TRABAJO </label>
            </div>
        </div>
          <div class="row">
          <div class="field-body">
            <div class="field">
              <div class="field has-addons">
                <div class="row">
                <p class="control">
                  <input class="input is-danger" type="number" placeholder="1" id="horasTrabajo" name="horasRegistradas">
                </p>
              </div>
            </div>
            </div>
          </div>
        </div>
      </div>


        <div class="field is-grouped is-grouped-centered">
          <p class="control">
            <input type="submit" onclick="postTarea()" value="Agregar"  class="button botonAgregarTarea is-success is-outlined">
            
          </p>
          
          <p class="control">
            <input type="reset" value="Cancelar" class="button botonCancelarTarea is-danger is-outlined" >
          </p>
        </div>
      </div>

      <script>
        const accion_asincrona = () => {
          const valor = document.getElementById('buscar').value;
          //función que manda la petición asíncrona
          fetch('/proyecto/buscar/' + valor, {
            method: 'GET',
          }).then(result => {
            return result.json(); //Regresa otra promesa
          }).then(data => {
            //Modificamos el DOM de nuestra página de acuerdo a los datos de la segunda promesa
            console.log(data);
            
            let html = '';
            if (data.proyecto.length > 0) {
              html = '';
                for (p of data.proyecto) {
                  html += '<div class="card">';
                  html += '<header class="card-header">';
                  html += '<p class="card-header-title">';
                  html += p.nombreP;
                  html += '</p>';
                  html += '</header>';
                  html += '</div>';




                  // html += '<div class="select">';
                  // html += '<select>';
                  // html += '<option>Select dropdown</option>'
                  // for (let p of proyecto) {
                  //   html += 'option value='
                  //   p.idProyecto
                  //   html += '</option>'

                    // html += p.nombreP;
                    // html += '<br>';
                  // }
                }
            } else {
              html = '<h2>No hay proyectos registrados que coincidan con los criterios de búsqueda</h2>';
            }
                document.getElementById("listaProyectos").innerHTML = html;
            }).catch(err => {
                console.log(err);
             });
          };
        document.getElementById('buscar').onkeyup = accion_asincrona
      </script>
        
        <!-- </form> 
        <script>
        let numero = 0;
        const contador = document.getElementById("contar");
        function sumarCont(){
          numero;
          contador = numero;
        }
        function restarCont(){
          if (numero == 0){
          }
          else{
              numero--;
              contador = numero;
          }
          return contador; 
        }-->
        </script>
        <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
        <script src="/js/scriptRegTarea.js"></script>
        </div>
      
    </div>